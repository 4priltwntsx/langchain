해당 파일에서 **"문서 관련성 평가 로직 구현"**을 참고하려면 아래 부분을 집중적으로 살펴보면 됩니다:

1. 데이터 모델 정의
   역할:
   문서의 관련성을 평가한 결과를 구조화된 형식으로 반환하기 위한 데이터 모델입니다.
   binary_score 필드는 문서가 질문과 관련이 있는지 여부를 'yes' 또는 'no'로 나타냅니다.
2. LLM 초기화 및 구조화된 출력 생성
   역할:
   OpenAI의 언어 모델(ChatOpenAI)을 초기화합니다.
   with_structured_output을 사용하여 모델의 출력을 GradeDocuments 데이터 모델에 맞게 구조화합니다.
   이 부분은 문서 평가 결과를 'yes' 또는 'no'로 반환하도록 설정합니다.
3. 프롬프트 템플릿 생성
   역할:
   system 메시지로 모델의 역할과 평가 기준을 정의합니다.
   human 메시지로 검색된 문서({document})와 사용자 질문({question})을 전달합니다.
   이 프롬프트는 문서와 질문의 관련성을 평가하는 기준을 제공합니다.
4. 문서 평가기 생성
   역할:
   프롬프트 템플릿(grade_prompt)과 구조화된 출력 생성기(structured_llm_grader)를 연결합니다.
   retrieval_grader는 문서와 질문을 입력으로 받아 관련성을 평가하고 결과를 반환합니다.
   참고해야 할 주요 흐름
   문서 평가의 기준:

system 메시지에서 정의된 기준을 참고하세요.
문서가 질문과 관련된 키워드나 의미를 포함하면 'yes'로 평가됩니다.
문서 평가 호출 방식:

retrieval_grader를 호출하여 문서와 질문의 관련성을 평가합니다.
예:
구조화된 출력:

평가 결과는 GradeDocuments 데이터 모델에 따라 반환됩니다.
결과는 binary_score 필드에 'yes' 또는 'no'로 저장됩니다.
결론
문서 관련성 평가 로직은 retrieval_grader를 통해 구현됩니다.
파일에서 프롬프트 템플릿 생성과 LLM 초기화 부분을 참고하여, 문서와 질문을 입력으로 전달하고 평가 결과를 확인하면 됩니다.
추가적으로, 평가 결과를 활용하여 관련 문서를 필터링하거나 응답 생성을 위한 다음 단계를 구현할 수 있습니다.
